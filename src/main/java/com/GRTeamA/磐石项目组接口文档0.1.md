# 创建账户
## 请求格式
发送Post请求：http://172.16.8.58:8000?amount=100000000&auth_key=account.authKey.hex()&currency_code=XUS&return_txns=true

## 参数解释
1. 向172.16.8.58:8000发送post请求
2. 请求的参数params中：
	* amount、currency_code、return_txns为固定值，无需更改
	* auth_key为生成的账号的AuthKey，需转为16进制（.hex()方法即可）

## 返回值
1. 如果response的status为200即创建成功
2. 若账户创建成功，response返回一个账户结构体，包含密钥、地址等信息。可以使用账户的address查询账户信息，以验证注册是否成功

## 注意事项
1. 在本操作中，账户的创建是在本地完成，通过本操作提交到区块链网络进行注册和认证，本地创建账户的代码我们稍后会提供。

# 获取账户信息
利用“创建账户”中的获得的address可以进行获取账户信息操作

## 实现

linux下命令：

curl -X POST -H "Content-Type: application/json" --data '{"jsonrpc":"2.0", "method":"get_account", "params":["a120e1919000dfb6d126beab5a76140f"], "id":1}' 172.16.8.58:8080

windows下命令（单引号改双引号，双引号内部使用双引号需使用转义双引号 \\"）：

curl -X POST -H "Content-Type: application/json" --data "{\"jsonrpc\":\"2.0\", \"method\":\"get_account\", \"params\":[\"a120e1919000dfb6d126beab5a76140f\"], \"id\":1}" 172.16.8.58:8080

jsonrpc格式：

requstJson:{"jsonrpc":"2.0","method":"get_account","params":["a120e1919000dfb6d126beab5a76140f"],"id":1}
postUrl:172.16.8.58:8080
postHeader:content-type: application/json

## 参数解释
1. 向172.16.8.58:8080发送post请求
2. 请求中header的Content-Type为application/json
3. 请求中body：
	* jsonrpc、method、id不变
	* params中为需要查询账户的address

## 返回值

​			包含多个结构体，可能对项目开发有用的属性包括"address","authentication_key""balances"



# 存证
## 流程说明
1. 对需要存证的字符串包装生成一个交易，然后对交易进行签名
2. 对签名后的交易进行序列化
3. 将序列化结果通过Post请求发送到172.16.8.58:8080
4. 返回一个存证完成的Hash，存证完成

## 实现
curl -X POST -H "Content-Type: application/json" --data '{"jsonrpc":"2.0", "method":"submit", "params":["签名并序列化后的交易结果"], "id":1}' 172.16.8.58:8080

## 交易包含内容
1. sender：发送方的address
2. sequence number：发送方的交易序列号（初始为0）
3. payload：交易脚本
4. max_gas_amount：1000000
5. gas_unit_price：0
6. gas_currency_code："XUS"
7. expiration_timestamp_secs：100000000000
8. chain_id：4

## payload包含内容
1. payee：接收方的address
2. amount：1

## 创建Post请求
1. 对签名的交易使用bcs序列化，得到序列化结果（java有实现bcs套件，https://github.com/PhzCode/bcs/tree/master）
2. 和‘获取账户信息’类似构造Post请求：
  * method是submit
  * params是第一步序列化结果（String）

## response分析
执行成功的返回结果为：
{"diem_chain_id":4,"diem_ledger_version":555078,"diem_ledger_timestampusec":1616487775396718,"jsonrpc":"2.0","id":1,"result":null}

# 获取账户交易记录
## 说明
1. 获取账户交易记录时，可以获取某账户的特定sequence number的交易（一个），也可以获取某账户从某sequence number开始的指定数量的交易（多个）
2. 获取交易记录的实现和获取账户信息的实现是类似的，只有method和params需要修改
3. 对于获取单个交易，method是get_account_transaction，params按顺序分别是account address、sequence number、结果是否显示交易事件（布尔值），总共三个参数
	* eg: curl -X POST -H "Content-Type: application/json" --data '{"jsonrpc":"2.0", "method":"get_account_transaction", "params":["4D17E12148BD23695E3D5E77A4ECAFD5",0,true], "id":1}' 172.16.8.58:8080
4. 对于获取多个交易，method是get_account_transactions，params按顺序分别是account address、起始的sequence number、需要查询的交易总个数、结果是否显示交易事件（布尔值），总共四个参数
	* eg:curl -X POST -H "Content-Type: application/json" --data '{"jsonrpc":"2.0", "method":"get_account_transactions", "params":["4D17E12148BD23695E3D5E77A4ECAFD5",0,10,true], "id":1}' 172.16.8.58:8080

## response
示例返回单个交易的response：
{"diem_chain_id":4,"diem_ledger_version":934004,"diem_ledger_timestampusec":1616552852639049,"jsonrpc":"2.0","id":1,"result":{"bytes":"...","events":[{"data":{"amount":{"amount":2,"currency":"XUS"},"metadata":"","receiver":"...","sender":"...","type":"sentpayment"},"key":"...","sequence_number":0,"transaction_version":555082},{"data":{"amount":{"amount":2,"currency":"XUS"},"metadata":"","receiver":"...","sender":"...","type":"receivedpayment"},"key":"...","sequence_number":1,"transaction_version":555082}],"gas_used":0,"hash":"...","transaction":{"chain_id":4,"expiration_timestamp_secs":100000000000,"gas_currency":"XUS","gas_unit_price":0,"max_gas_amount":1000000,"public_key":"...","script":{"arguments":["{U64: 3}","{ADDRESS: ...}","{U64: 2}"],"code":"...","type":"peer_to_peer_with_metadata","type_arguments":["XUS"]},"script_bytes":"...","script_hash":"...","sender":"...","sequence_number":0,"signature":"...","signature_scheme":"Scheme::Ed25519","type":"user"},"version":555082,"vm_status":{"type":"executed"}}}